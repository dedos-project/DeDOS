\hypertarget{message__queue_8c}{\section{src/runtime/message\-\_\-queue.c File Reference}
\label{message__queue_8c}\index{src/runtime/message\-\_\-queue.\-c@{src/runtime/message\-\_\-queue.\-c}}
}


Structures and functions for enqueueing and dequeuing general-\/purpose messages from a queue.  


{\ttfamily \#include \char`\"{}message\-\_\-queue.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}logging.\-h\char`\"{}}\\*
{\ttfamily \#include $<$time.\-h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{message__queue_8c_a3cb1d2ec4005512fec77eab1a717b459}{enqueue\-\_\-msg} (struct \hyperlink{structmsg__queue}{msg\-\_\-queue} $\ast$q, struct \hyperlink{structdedos__msg}{dedos\-\_\-msg} $\ast$msg)
\begin{DoxyCompactList}\small\item\em Enqueues a message to be delivered as soon as possible. \end{DoxyCompactList}\item 
int \hyperlink{message__queue_8c_a45248549a7063010db087fe9b3b68765}{schedule\-\_\-msg} (struct \hyperlink{structmsg__queue}{msg\-\_\-queue} $\ast$q, struct \hyperlink{structdedos__msg}{dedos\-\_\-msg} $\ast$msg, struct timespec $\ast$interval)
\begin{DoxyCompactList}\small\item\em Schedules a message to be delivered once {\ttfamily interval} time has passed. \end{DoxyCompactList}\item 
static double \hyperlink{message__queue_8c_a8229f86491e42d208c45d0fd522f5618}{timediff\-\_\-s} (struct timespec $\ast$t1, struct timespec $\ast$t2)
\begin{DoxyCompactList}\small\item\em Returns the difference in time in seconds, t2 -\/ t1. \end{DoxyCompactList}\item 
struct \hyperlink{structdedos__msg}{dedos\-\_\-msg} $\ast$ \hyperlink{message__queue_8c_a8fe020bd7b0beb4881bc21f35ebd288c}{dequeue\-\_\-msg} (struct \hyperlink{structmsg__queue}{msg\-\_\-queue} $\ast$q)
\begin{DoxyCompactList}\small\item\em Dequeues the first available message from {\ttfamily q}. \end{DoxyCompactList}\item 
int \hyperlink{message__queue_8c_a475676d4d62424d511cd2ebb12919f37}{init\-\_\-msg\-\_\-queue} (struct \hyperlink{structmsg__queue}{msg\-\_\-queue} $\ast$q, sem\-\_\-t $\ast$sem)
\begin{DoxyCompactList}\small\item\em Initilializes a mesasge queue to have no messages in it, and sets up the mutex and semaphore. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static struct timespec \hyperlink{message__queue_8c_af70636c944dda5448c9a9feb70ddc439}{zero} = \{\}
\begin{DoxyCompactList}\small\item\em Interval 0 seconds from now. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Structures and functions for enqueueing and dequeuing general-\/purpose messages from a queue. 

Definition in file \hyperlink{message__queue_8c_source}{message\-\_\-queue.\-c}.



\subsection{Function Documentation}
\hypertarget{message__queue_8c_a8fe020bd7b0beb4881bc21f35ebd288c}{\index{message\-\_\-queue.\-c@{message\-\_\-queue.\-c}!dequeue\-\_\-msg@{dequeue\-\_\-msg}}
\index{dequeue\-\_\-msg@{dequeue\-\_\-msg}!message_queue.c@{message\-\_\-queue.\-c}}
\subsubsection[{dequeue\-\_\-msg}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf dedos\-\_\-msg}$\ast$ dequeue\-\_\-msg (
\begin{DoxyParamCaption}
\item[{struct {\bf msg\-\_\-queue} $\ast$}]{q}
\end{DoxyParamCaption}
)}}\label{message__queue_8c_a8fe020bd7b0beb4881bc21f35ebd288c}


Dequeues the first available message from {\ttfamily q}. 

If there are no messages, or no messages with a suitable delivery time, returns N\-U\-L\-L. \begin{DoxyReturn}{Returns}
\hyperlink{structdedos__msg}{dedos\-\_\-msg} dequeued, or N\-U\-L\-L 
\end{DoxyReturn}


Definition at line 87 of file message\-\_\-queue.\-c.

\hypertarget{message__queue_8c_a3cb1d2ec4005512fec77eab1a717b459}{\index{message\-\_\-queue.\-c@{message\-\_\-queue.\-c}!enqueue\-\_\-msg@{enqueue\-\_\-msg}}
\index{enqueue\-\_\-msg@{enqueue\-\_\-msg}!message_queue.c@{message\-\_\-queue.\-c}}
\subsubsection[{enqueue\-\_\-msg}]{\setlength{\rightskip}{0pt plus 5cm}int enqueue\-\_\-msg (
\begin{DoxyParamCaption}
\item[{struct {\bf msg\-\_\-queue} $\ast$}]{q, }
\item[{struct {\bf dedos\-\_\-msg} $\ast$}]{msg}
\end{DoxyParamCaption}
)}}\label{message__queue_8c_a3cb1d2ec4005512fec77eab1a717b459}


Enqueues a message to be delivered as soon as possible. 

\begin{DoxyReturn}{Returns}
0 on success, -\/1 on error 
\end{DoxyReturn}


Definition at line 34 of file message\-\_\-queue.\-c.

\hypertarget{message__queue_8c_a475676d4d62424d511cd2ebb12919f37}{\index{message\-\_\-queue.\-c@{message\-\_\-queue.\-c}!init\-\_\-msg\-\_\-queue@{init\-\_\-msg\-\_\-queue}}
\index{init\-\_\-msg\-\_\-queue@{init\-\_\-msg\-\_\-queue}!message_queue.c@{message\-\_\-queue.\-c}}
\subsubsection[{init\-\_\-msg\-\_\-queue}]{\setlength{\rightskip}{0pt plus 5cm}int init\-\_\-msg\-\_\-queue (
\begin{DoxyParamCaption}
\item[{struct {\bf msg\-\_\-queue} $\ast$}]{q, }
\item[{sem\-\_\-t $\ast$}]{sem}
\end{DoxyParamCaption}
)}}\label{message__queue_8c_a475676d4d62424d511cd2ebb12919f37}


Initilializes a mesasge queue to have no messages in it, and sets up the mutex and semaphore. 

\begin{DoxyReturn}{Returns}
0 on success, -\/1 on error 
\end{DoxyReturn}


Definition at line 153 of file message\-\_\-queue.\-c.

\hypertarget{message__queue_8c_a45248549a7063010db087fe9b3b68765}{\index{message\-\_\-queue.\-c@{message\-\_\-queue.\-c}!schedule\-\_\-msg@{schedule\-\_\-msg}}
\index{schedule\-\_\-msg@{schedule\-\_\-msg}!message_queue.c@{message\-\_\-queue.\-c}}
\subsubsection[{schedule\-\_\-msg}]{\setlength{\rightskip}{0pt plus 5cm}int schedule\-\_\-msg (
\begin{DoxyParamCaption}
\item[{struct {\bf msg\-\_\-queue} $\ast$}]{q, }
\item[{struct {\bf dedos\-\_\-msg} $\ast$}]{msg, }
\item[{struct timespec $\ast$}]{interval}
\end{DoxyParamCaption}
)}}\label{message__queue_8c_a45248549a7063010db087fe9b3b68765}


Schedules a message to be delivered once {\ttfamily interval} time has passed. 

\begin{DoxyReturn}{Returns}
0 on success, -\/1 on error 
\end{DoxyReturn}


Definition at line 38 of file message\-\_\-queue.\-c.

\hypertarget{message__queue_8c_a8229f86491e42d208c45d0fd522f5618}{\index{message\-\_\-queue.\-c@{message\-\_\-queue.\-c}!timediff\-\_\-s@{timediff\-\_\-s}}
\index{timediff\-\_\-s@{timediff\-\_\-s}!message_queue.c@{message\-\_\-queue.\-c}}
\subsubsection[{timediff\-\_\-s}]{\setlength{\rightskip}{0pt plus 5cm}static double timediff\-\_\-s (
\begin{DoxyParamCaption}
\item[{struct timespec $\ast$}]{t1, }
\item[{struct timespec $\ast$}]{t2}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{message__queue_8c_a8229f86491e42d208c45d0fd522f5618}


Returns the difference in time in seconds, t2 -\/ t1. 



Definition at line 83 of file message\-\_\-queue.\-c.



\subsection{Variable Documentation}
\hypertarget{message__queue_8c_af70636c944dda5448c9a9feb70ddc439}{\index{message\-\_\-queue.\-c@{message\-\_\-queue.\-c}!zero@{zero}}
\index{zero@{zero}!message_queue.c@{message\-\_\-queue.\-c}}
\subsubsection[{zero}]{\setlength{\rightskip}{0pt plus 5cm}struct timespec zero = \{\}\hspace{0.3cm}{\ttfamily [static]}}}\label{message__queue_8c_af70636c944dda5448c9a9feb70ddc439}


Interval 0 seconds from now. 



Definition at line 32 of file message\-\_\-queue.\-c.

